from database import get_prompt, error_logged
from search import search_resources
from llm import call_llm  # <-- –Ω–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç
import traceback

# –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤ main.py –¥–ª—è chat_respond
def chat_respond(message, history):
    if "–ø–ª–∞–Ω" in message.lower():
        return plan_agent(message)
    elif "–Ω–∞–π–¥–∏" in message.lower() or "—Ä–µ—Å—É—Ä—Å" in message.lower() or "—Å—Ç–∞—Ç—å—è" in message.lower():
        return search_agent(message)
    else:
        return "–Ø –º–æ–≥—É: —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è, –Ω–∞–π—Ç–∏ —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª, –ø—Ä–æ–≤–µ—Å—Ç–∏ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∫–ª–∞–¥–∫—É."

@error_logged
def plan_agent(user_input: str) -> str:
    prompt_template = get_prompt("plan_agent")
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≥—Ä–µ–π–¥ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
    if "junior" in user_input.lower():
        grade = "Junior"
    elif "middle" in user_input.lower():
        grade = "Middle"
    else:
        grade = "General"
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è LLM
    full_prompt = prompt_template.format(grade=grade)
    # –î–æ–±–∞–≤–ª—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    full_prompt += f"\n\n–ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {user_input}"
    
    # –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç LLM
    llm_response = call_llm(full_prompt, system_prompt="–¢—ã ‚Äî –æ–ø—ã—Ç–Ω—ã–π HR-–∞–Ω–∞–ª–∏—Ç–∏–∫ –∏ –∫–∞—Ä—å–µ—Ä–Ω—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç. –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.")
    
    # –ï—Å–ª–∏ LLM –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω
    if llm_response.startswith("‚ö†Ô∏è") or llm_response.startswith("‚ùå"):
        # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω (–∫–∞–∫ –±—ã–ª–æ —Ä–∞–Ω—å—à–µ)
        if grade == "Junior":
            plan = """
üìö **–ù–µ–¥–µ–ª—è 1:** –û—Å–Ω–æ–≤—ã SQL (SELECT, JOIN, –∞–≥—Ä–µ–≥–∞—Ü–∏—è) ‚Äî —Ç—Ä–µ–Ω–∞–∂—ë—Ä SQL-EX  
üìö **–ù–µ–¥–µ–ª—è 2:** –ù–æ—Ç–∞—Ü–∏—è BPMN 2.0, —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º ‚Äî –≤–∏–¥–µ–æ –Ω–∞ YouTube  
üìö **–ù–µ–¥–µ–ª—è 3:** REST API, OpenAPI, Postman ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger  
üìö **–ù–µ–¥–µ–ª—è 4:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∞—Ç—Ç–µ—Å—Ç–∞—Ü–∏–∏, mock-–∏–Ω—Ç–µ—Ä–≤—å—é, soft skills  
"""
        elif grade == "Middle":
            plan = """
üöÄ **–ù–µ–¥–µ–ª—è 1:** –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API, –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, –ø–∞–≥–∏–Ω–∞—Ü–∏—è  
üöÄ **–ù–µ–¥–µ–ª—è 2:** Kafka basics, event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –ø—Ä–æ—Ç–æ–∫–æ–ª—ã  
üöÄ **–ù–µ–¥–µ–ª—è 3:** Event Storming, DDD, bounded context  
üöÄ **–ù–µ–¥–µ–ª—è 4:** –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤—å—é, –º–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ, code review  
"""
        else:
            plan = """
üéØ **–ù–µ–¥–µ–ª—è 1:** SQL (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∏–Ω–¥–µ–∫—Å—ã)  
üéØ **–ù–µ–¥–µ–ª—è 2:** BPMN, CMMN, DMN ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ  
üéØ **–ù–µ–¥–µ–ª—è 3:** REST, gRPC, GraphQL ‚Äî –∫–æ–≥–¥–∞ —á—Ç–æ –≤—ã–±–∏—Ä–∞—Ç—å  
üéØ **–ù–µ–¥–µ–ª—è 4:** –°–æ—Ñ—Ç-—Å–∫–∏–ª–ª—ã: –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å –∑–∞–∫–∞–∑—á–∏–∫–æ–º, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è–º–∏  
"""
        return f"**–ü—Ä–æ–º–ø—Ç –∞–≥–µ–Ω—Ç–∞:** {prompt_template.format(grade=grade)}\n\n{plan}\n\n*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω, —Ç–∞–∫ –∫–∞–∫ AI-–ø–æ–º–æ—â–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.*"
    else:
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç LLM
        return f"**–ü—Ä–æ–º–ø—Ç –∞–≥–µ–Ω—Ç–∞:** {prompt_template.format(grade=grade)}\n\n**AI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**\n{llm_response}"

@error_logged
def validate_file(content: str, filename: str, question: str) -> str:
    prompt = get_prompt("validator")
    ext = filename.split(".")[-1].lower() if "." in filename else ""
    try:
        import sqlparse
    except ImportError:
        sqlparse = None
    if ext in ["sql", "txt"] and ("SELECT" in content or "select" in content):
        if sqlparse:
            try:
                parsed = sqlparse.parse(content)
                if parsed:
                    verdict = "‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å SQL –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω. "
                    if "join" in content.lower():
                        verdict += "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω JOIN, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∏–ø—ã."
                    else:
                        verdict += "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏—è WHERE –∏ –∏–Ω–¥–µ–∫—Å—ã."
                else:
                    verdict = "‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π SQL-–∑–∞–ø—Ä–æ—Å."
            except:
                verdict = "‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ SQL."
        else:
            verdict = "‚úÖ SQL-–∑–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–µ–Ω (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ sqlparse –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏)."
    elif ext in ["bpmn", "xml", "txt"] and ("Actor" in content or "Flow" in content or "process" in content.lower()):
        verdict = "‚úÖ BPMN-–¥–∏–∞–≥—Ä–∞–º–º–∞ –æ–ø–∏—Å–∞–Ω–∞ –≤–µ—Ä–Ω–æ. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏."
    else:
        verdict = "‚ùå –§–æ—Ä–º–∞—Ç –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω. –ó–∞–≥—Ä—É–∑–∏—Ç–µ SQL-–∑–∞–ø—Ä–æ—Å (.sql), BPMN-—Å—Ö–µ–º—É (.bpmn) –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ."
    return f"**–ü—Ä–æ–º–ø—Ç –∞–≥–µ–Ω—Ç–∞:** {prompt.format(question=question, content=content[:50])}\n\n**–í–µ—Ä–¥–∏–∫—Ç:** {verdict}"

@error_logged
def search_agent(query: str) -> str:
    # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤–Ω—É—Ç—Ä–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
    from search import search_resources
    prompt = get_prompt("search_agent")
    resources = search_resources(query)
    return f"**–ü—Ä–æ–º–ø—Ç –∞–≥–µ–Ω—Ç–∞:** {prompt.format(query=query)}\n\n**–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã:**\n{resources}"

@error_logged
def interview_agent(topic: str, grade: str) -> str:
    prompt = get_prompt("interview_agent")
    questions_db = {
        "sql": [
            "–ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è INNER JOIN –æ—Ç LEFT JOIN?",
            "–ß—Ç–æ —Ç–∞–∫–æ–µ –∏–Ω–¥–µ–∫—Å –∏ –∫–æ–≥–¥–∞ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?",
            "–û–±—ä—è—Å–Ω–∏—Ç–µ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É UNION –∏ UNION ALL."
        ],
        "bpmn": [
            "–ö–∞–∫–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã BPMN 2.0 –≤—ã –∑–Ω–∞–µ—Ç–µ?",
            "–ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç –ø–æ–¥–ø—Ä–æ—Ü–µ—Å—Å–∞?",
            "–ö–∞–∫ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –≤ BPMN?"
        ],
        "api": [
            "–ß—Ç–æ —Ç–∞–∫–æ–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤ REST?",
            "–ö–∞–∫–∏–µ —Å—Ç–∞—Ç—É—Å-–∫–æ–¥—ã HTTP –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —á–∞—â–µ –≤—Å–µ–≥–æ?",
            "–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É PUT –∏ PATCH?"
        ]
    }
    topic_lower = topic.lower()
    questions = []
    for key in questions_db:
        if key in topic_lower:
            questions = questions_db[key][:3]
            break
    if not questions:
        questions = [
            "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–º –æ–ø—ã—Ç–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.",
            "–ö–∞–∫ –≤—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è?",
            "–ö–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è?"
        ]
    return f"**–¢–µ–º–∞:** {topic} ({grade})\n\n**–í–æ–ø—Ä–æ—Å—ã:**\n" + "\n".join([f"{i+1}. {q}" for i, q in enumerate(questions)])

@error_logged
def generate_plan_by_interests(interests: list, total_questions: int = 10) -> str:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤.
    –ï—Å–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ 5 –∏–ª–∏ –±–æ–ª—å—à–µ ‚Äì —Å—Ç—Ä–æ–∏—Ç –ø–ª–∞–Ω –ø–æ –Ω–∏–º.
    –ï—Å–ª–∏ –º–µ–Ω—å—à–µ ‚Äì –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–ª–∞–Ω.
    """
    count = len(interests)
    interests_text = "\n".join([f"- {interest}" for interest in interests])

    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç –¥–ª—è LLM
    if count >= 5:
        prompt = (
            f"–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫ –≤—ã–±—Ä–∞–ª {count} –∏–∑ {total_questions} –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –µ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã:\n"
            f"{interests_text}\n\n"
            "–°–æ—Å—Ç–∞–≤—å –¥–ª—è –Ω–µ–≥–æ –ø–æ–¥—Ä–æ–±–Ω—ã–π –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –Ω–∞ 4 –Ω–µ–¥–µ–ª–∏. "
            "–í–∫–ª—é—á–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ–º—ã, —É—á–µ–±–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (–∫–Ω–∏–≥–∏, –∫—É—Ä—Å—ã, —Å—Ç–∞—Ç—å–∏) –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è. "
            "–ü–ª–∞–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã."
        )
    else:
        prompt = (
            f"–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫ –≤—ã–±—Ä–∞–ª —Ç–æ–ª—å–∫–æ {count} –∏–∑ {total_questions} –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π:\n"
            f"{interests_text}\n\n"
            "–≠—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —É–∑–∫–æ–π —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏. –ü—Ä–µ–¥–ª–æ–∂–∏ –µ–º—É –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è, "
            "–∫–æ—Ç–æ—Ä—ã–π –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –±–∞–∑–æ–≤—ã–µ –Ω–∞–≤—ã–∫–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –∞ —Ç–∞–∫–∂–µ –≤–∫–ª—é—á–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö "
            "–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π, —á—Ç–æ–±—ã —Ä–∞—Å—à–∏—Ä–∏—Ç—å –µ–≥–æ –∫—Ä—É–≥–æ–∑–æ—Ä. –ü–ª–∞–Ω –Ω–∞ 4 –Ω–µ–¥–µ–ª–∏ —Å —Ç–µ–º–∞–º–∏, —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∏ –∑–∞–¥–∞–Ω–∏—è–º–∏."
        )

    # –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è LLM
    system_prompt = (
        "–¢—ã ‚Äî –æ–ø—ã—Ç–Ω—ã–π HR-–∞–Ω–∞–ª–∏—Ç–∏–∫ –∏ –∫–∞—Ä—å–µ—Ä–Ω—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç. "
        "–¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–π, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏ –ø–æ–ª–µ–∑–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞. "
        "–û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ."
    )

    # –í—ã–∑—ã–≤–∞–µ–º LLM
    llm_response = call_llm(prompt, system_prompt)

    # –ï—Å–ª–∏ LLM –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø–∞—Å–Ω–æ–π –ø–ª–∞–Ω
    if llm_response.startswith("‚ö†Ô∏è") or llm_response.startswith("‚ùå") or llm_response.startswith("–û—à–∏–±–∫–∞"):
        # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        default_plan = """
üìå **–ë–∞–∑–æ–≤—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (4 –Ω–µ–¥–µ–ª–∏)**

**–ù–µ–¥–µ–ª—è 1:** –û—Å–Ω–æ–≤—ã —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- –ò–∑—É—á–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ü–û (SDLC).
- –°–±–æ—Ä –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π (user stories, use cases).
- –†–µ—Å—É—Ä—Å—ã: –∫–Ω–∏–≥–∞ ¬´Software Requirements¬ª (Karl Wiegers), –∫—É—Ä—Å –Ω–∞ Stepik.

**–ù–µ–¥–µ–ª—è 2:** –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–æ—Ç–∞—Ü–∏–∏
- BPMN 2.0, UML (–¥–∏–∞–≥—Ä–∞–º–º—ã –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π).
- –ü—Ä–∞–∫—Ç–∏–∫–∞: —Å–æ–∑–¥–∞—Ç—å BPMN-–¥–∏–∞–≥—Ä–∞–º–º—É –ø—Ä–æ—Å—Ç–æ–≥–æ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞.

**–ù–µ–¥–µ–ª—è 3:** –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ SQL
- –û—Å–Ω–æ–≤—ã SQL (SELECT, JOIN, –∞–≥—Ä–µ–≥–∞—Ü–∏—è).
- –†–∞–±–æ—Ç–∞ —Å –°–£–ë–î (PostgreSQL, MySQL).
- –¢—Ä–µ–Ω–∞–∂—ë—Ä SQL-EX, Stepik.

**–ù–µ–¥–µ–ª—è 4:** –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è –∏ soft skills
- –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∑–∞–∫–∞–∑—á–∏–∫–æ–º, –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤—å—é.
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è–º–∏, –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π.
- Mock-–∏–Ω—Ç–µ—Ä–≤—å—é, –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
"""
        return f"**AI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –±–∞–∑–æ–≤—ã–π –ø–ª–∞–Ω:**\n{default_plan}"
    else:
        return f"**AI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**\n{llm_response}"